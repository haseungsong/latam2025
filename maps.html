<!DOCTYPE html>
<html>
<head>
  <title>경로 안내 (São Paulo)</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #map {
      height: 80vh;
      width: 100%;
    }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <h1 class="text-xl font-bold mb-4 text-center">📍 목적지 선택</h1>

  <div class="grid grid-cols-2 gap-4 mb-4 max-w-md mx-auto">
    <button onclick="routeTo('museu')" class="bg-white py-2 px-4 rounded shadow hover:bg-gray-200">🏛️ Museu do Ipiranga</button>
    <button onclick="routeTo('paulista')" class="bg-white py-2 px-4 rounded shadow hover:bg-gray-200">🏙️ Av. Paulista</button>
    <button onclick="routeTo('ibirapuera')" class="bg-white py-2 px-4 rounded shadow hover:bg-gray-200">🌳 Ibirapuera Park</button>
    <button onclick="routeTo('mercado')" class="bg-white py-2 px-4 rounded shadow hover:bg-gray-200">🛍️ Mercado Municipal</button>
  </div>

  <div id="map"></div>

  <script>
    const destinations = {
      museu: { lat: -23.5854, lng: -46.6237 },         // Museu do Ipiranga
      paulista: { lat: -23.5614, lng: -46.6559 },      // Av. Paulista
      ibirapuera: { lat: -23.5874, lng: -46.6576 },    // Parque Ibirapuera
      mercado: { lat: -23.5411, lng: -46.6275 }        // Mercado Municipal
    };

    let map, directionsService, directionsRenderer;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 13,
        center: { lat: -23.55, lng: -46.63 },
      });

      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer();
      directionsRenderer.setMap(map);
    }

    function routeTo(key) {
      const destination = destinations[key];

      navigator.geolocation.getCurrentPosition(
        (position) => {
          const origin = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };

          directionsService.route(
            {
              origin: origin,
              destination: destination,
              travelMode: google.maps.TravelMode.DRIVING,
            },
            (response, status) => {
              if (status === "OK") {
                directionsRenderer.setDirections(response);
              } else {
                alert("경로를 찾을 수 없습니다: " + status);
              }
            }
          );
        },
        () => alert("현재 위치를 가져올 수 없습니다.")
      );
    }
  </script>

  <!-- ✅ Google Maps JS API (API 키 필수) -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAfHkgQ8w0T0-JlGESZiLbFAAgULg46I4A&callback=initMap">
  </script>
</body>
</html>
